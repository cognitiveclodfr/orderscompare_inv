# Технічна задача: Інтерактивний скрипт обробки замовлень Shopify

## Опис проекту
Розробити інтерактивний Python скрипт для фільтрації та обробки експорту замовлень з Shopify. Скрипт розраховує вартість обробки замовлень на основі тарифів, введених користувачем, та генерує детальний багатосторінковий звіт у форматі Excel.

## Основні вимоги

### Вхідні дані
- **Назва файлу**: `orders_export.csv` (має знаходитись у тій самій директорії, що і скрипт).
- **Формат**: Стандартний CSV експорт з Shopify.
- **Обов'язкові колонки**: `Name`, `Fulfilled at`, `Lineitem quantity`, `Lineitem name`, `Lineitem sku`, `Total`.

### Функціональність

#### 1. Інтерактивне введення параметрів
- Скрипт запитує у користувача в терміналі:
    - Дату початку періоду (формат: `ДД.ММ.РРРР`).
    - Дату кінця періоду (формат: `ДД.ММ.РРРР`).
    - Тариф за перший SKU в замовленні.
    - Тариф за кожен наступний унікальний SKU.
    - Тариф за кожну одиницю товару (штуку).
- Надає можливість вказати ім'я вихідного файлу або використовує ім'я за замовчуванням.

#### 2. Обробка даних
- **Очищення даних**: Автоматично видаляє зайві пробіли в колонці `Name` (номер замовлення) для уникнення помилок групування.
- **Фільтрація за датою**: Відбирає замовлення, що були виконані (`Fulfilled at`) у вказаному діапазоні дат.
- **Розрахунок вартості по позиціях**:
    - Розраховує вартість обробки для кожного окремого рядка товару.
    - Ігнорує товари, назва яких містить "Package protection" або "Shipping Protection".
    - Кожен рядок товару у звіті має деталізовану вартість (`Piece Cost`, `SKU Cost`, `Line Total Cost`).

#### 3. Генерація звіту Excel
- Створює багатосторінковий `.xlsx` файл з чотирма аркушами.
- Застосовує професійне форматування: жирні заголовки, автопідбір ширини колонок, закріплена верхня панель, фільтри.
- Чітко візуально розділяє замовлення на аркуші "Cost Calculation" за допомогою жирної лінії під кожним рядком `TOTAL`.

## Структура вихідного файлу Excel

Вихідний файл містить 4 аркуші:

1.  **All Orders**: Усі рядки всіх замовлень, що потрапили у вибраний діапазон дат.
2.  **Without Package Protection**: Та сама таблиця, але без рядків "Package protection" та "Shipping Protection".
3.  **Cost Calculation**: Детальний розрахунок вартості для кожного замовлення.
    - **Колонки**: `Name`, `Fulfilled at`, `Lineitem quantity`, `Lineitem name`, `Lineitem sku`, `Piece Cost`, `SKU Cost`, `Line Total Cost`.
    - **Структура**: Товарні позиції кожного замовлення йдуть одна за одною. Після всіх товарів замовлення додається підсумковий рядок **`TOTAL`**, який сумує всі витрати для цього замовлення.
4.  **Final Invoice**: Загальний зведений рахунок.
    - Агрегує загальну вартість по всіх оброблених замовленнях.
    - Показує розбивку за тарифами: загальна кількість перших SKU, наступних SKU, одиниць товару та їх сумарна вартість.

## Технічні вимоги

### Бібліотеки Python
- `pandas`
- `openpyxl`

### Структура скрипта
Скрипт побудований навколо головної функції `main()`, яка викликає допоміжні функції для:
- `get_date_from_user()`, `get_tariff_from_user()`: Отримання даних від користувача.
- `load_and_validate_csv()`: Завантаження та валідація CSV.
- `filter_by_date_range()`: Фільтрація замовлень.
- `calculate_costs()`: Розрахунок вартості по рядках.
- `prepare_report_sheets()`: Підготовка даних для всіх аркушів звіту.
- `transform_cost_df_for_reporting()`: Додавання рядків `TOTAL`.
- `create_invoice_summary()`: Створення фінального рахунку.
- `create_excel_report()`: Генерація та форматування Excel-файлу.

### Обробка помилок
- Перевірка наявності файлу `orders_export.csv`.
- Валідація коректності введених дат та числових тарифів.
- Інформативні повідомлення про помилки для користувача.

### Використання
1.  Помістити файл `orders_export.csv` в одну директорію зі скриптом.
2.  Встановити залежності: `pip install -r requirements.txt`.
3.  Запустити скрипт: `python shopify_order_processor.py`.
4.  Слідувати інструкціям у терміналі.
