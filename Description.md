# Технічна задача: Скрипт обробки замовлень Shopify

## Опис проекту
Розробити Python скрипт для фільтрації та обробки експорту замовлень з Shopify за визначеним періодом дат з виводом результатів у форматований Excel файл.

## Основні вимоги

### Вхідні дані
- **Формат вхідного файлу**: CSV експорт з Shopify
- **Кодування**: UTF-8
- **Структура**: Стандартний експорт замовлень Shopify з усіма стандартними колонками

### Функціональність

#### 1. Парсинг вхідних параметрів
- Приймати шлях до CSV файлу
- Приймати дату початку періоду (формат: ДД.ММ.РРРР)
- Приймати дату кінця періоду (формат: ДД.ММ.РРРР)
- Приймати назву вихідного файлу (опційно)

#### 2. Фільтрація замовлень
- Фільтрувати замовлення за полем "Fulfilled at"
- Включати замовлення, що були виконані в зазначений період (включно)
- Ігнорувати замовлення з порожнім полем "Fulfilled at"
- Обробляти часові зони коректно

#### 3. Обробка даних
- Групувати товарні позиції за номером замовлення
- Підраховувати загальну кількість артикулів в замовленні
- Формувати список артикулів у зручному для читання форматі

## Структура вихідного файлу Excel

### Колонки таблиці:
1. **Номер замовлення** (`Name`) - з вхідного поля "Name"
2. **Дата виконання** (`Fulfilled at`) - форматована дата з поля "Fulfilled at"
3. **Кількість позицій** - загальна кількість різних товарних позицій
4. **Загальна кількість товарів** - сума всіх "Lineitem quantity"
5. **Список артикулів** - перелік усіх "Lineitem name" через кому або з нового рядка
6. **SKU артикулів** - перелік усіх "Lineitem sku" (якщо наявні)
7. **Загальна сума** (`Total`) - з поля "Total"

### Форматування Excel:
- Заголовки виділені жирним шрифтом
- Автоматичне підгонка ширини колонок
- Фільтри на заголовках
- Заморожена перша строка
- Форматування дат у зрозумілому вигляді (ДД.ММ.РРРР ГГ:ХХ)

## Технічні вимоги

### Бібліотеки Python
```python
import pandas as pd
import openpyxl
from datetime import datetime
import argparse
import sys
```

### Структура скрипта

#### Функції:
1. `parse_arguments()` - парсинг аргументів командного рядка
2. `validate_date_format(date_string)` - валідація формату дати
3. `parse_shopify_csv(file_path)` - читання та первинна обробка CSV
4. `filter_orders_by_date(df, start_date, end_date)` - фільтрація за датами
5. `group_order_items(df)` - групування товарів за замовленнями
6. `format_excel_output(df, output_file)` - форматування та збереження Excel
7. `main()` - головна функція

### Обробка помилок
- Перевірка існування вхідного файлу
- Валідація формату дат
- Обробка порожніх або некоректних даних
- Інформативні повідомлення про помилки

### Використання
```bash
python shopify_processor.py input.csv --start-date 01.07.2025 --end-date 31.07.2025 --output result.xlsx
```

## Додаткові вимоги

### Логування
- Виводити інформацію про кількість оброблених записів
- Повідомляти про кількість відфільтрованих замовлень
- Показувати прогрес обробки для великих файлів

### Валідація даних
- Перевіряти наявність обов'язкових колонок у вхідному файлі
- Попереджати про пропущені дати виконання
- Перевіряти коректність формату дат

### Оптимізація
- Ефективна робота з великими файлами (понад 10,000 замовлень)
- Мінімальне використання пам'яті
- Швидка обробка дат

## Приклад очікуваного результату

| Номер замовлення | Дата виконання | Кількість позицій | Загальна кількість | Список артикулів | SKU артикулів | Загальна сума |
|------------------|----------------|-------------------|-------------------|------------------|---------------|---------------|
| #131638 | 26.08.2025 15:27 | 1 | 1 | Moto Jacket - Red - Small | 01-JK-0326-032-S | 935.20 EUR |

## Критерії готовності
- [ ] Скрипт успішно обробляє тестовий CSV файл
- [ ] Коректно фільтрує замовлення за датами
- [ ] Генерує читабельний Excel файл з правильним форматуванням
- [ ] Обробляє помилки та виводить зрозумілі повідомлення
- [ ] Документований код з коментарями
- [ ] Readme файл з інструкціями по використанню

## Тестування
- Тестування на файлах різного розміру
- Перевірка крайніх випадків (порожні файли, некоректні дати)
- Тестування різних форматів дат та часових зон
- Перевірка коректності групування замовлень з кількома товарними позиціями
